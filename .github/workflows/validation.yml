name: Validation

on:
  push:
    branches: [ main, 'feature/**' ]
  pull_request:
    branches: [ main ]

jobs:
  validate-project:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4

    - name: Set up JDK 17
      uses: actions/setup-java@v4
      with:
        java-version: '17'
        distribution: 'temurin'
        cache: maven

    - name: Run Validation Script
      run: |
        echo "Pipeline Fête de la Science"
        
        # Go into the Fetescience folder where pom.xml lives
        if [ -d "Fetescience" ]; then
          cd Fetescience
          echo "Entered Fetescience directory"
        fi

        if [ -f "pom.xml" ]; then
          echo "Maven détecté - tentative de compilation..."
          mvn compile -q || echo "Compilation échouée"
        else
          echo "Pas de Maven trouvé ici"
        fi
        
        echo "Terminé"
